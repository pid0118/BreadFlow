<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.breadflow.app.product.mapper.ProductMapper">
	<!-- 제품 전체조회 -->
	<select id="selectProductList" resultType="ProductVO">
		SELECT product_code,
			   product_name,
			   expiration_deadline,
			   purchase_price,
			   sale_price,
			   standard,
			   major,
			   sub
		FROM product
		<where>
			<if test="subList != null and subList.size() > 0">	
	    		<foreach item="item" index="index" collection="subList"
	        	open="sub in (" separator="," close=")">
	          	#{item}
	    		</foreach>
	    	</if>	
  		</where>
		ORDER BY product_code ASC
	</select>
	
	<!-- 제품명 단건조회 -->
	<select id="selectProductName" resultType="ProductVO">
		SELECT product_name
		FROM product
		WHERE product_name = #{productName}
	</select>
	
	<!-- 제품 상세조회 -->
	<select id="selectProduct" parameterType="string" resultType="ProductVO">
		SELECT product_code,
			   product_name,
			   expiration_deadline,
			   purchase_price,
			   sale_price,
			   safe_stock_quantity,
			   proplace,
			   product_image,
			   major,
			   sub,
			   unit,
			   standard,
			   amount
		FROM  product
		WHERE product_code = #{productCode}
	</select>
	
	<!-- 제품 코드 가져오기 -->
	<select id="selectProductCode" resultType="string">
		SELECT 'IB' || LPAD(SUBSTR(MAX(product_code), 3) +1, 5, '0') FROM product
	</select>
	
	<!-- 제품 등록 -->
	<insert id="insertProduct" parameterType="ProductVO">
		INSERT INTO product
		(
		    product_code,
			product_name,
			expiration_deadline,
			purchase_price,
			sale_price,
			safe_stock_quantity,
			proplace,
			product_image,
			major,
			sub,
			unit,
			standard,
			amount
		) VALUES (
		      #{productCode}
		    , #{productName}
		    , #{expirationDeadline}
		    , #{purchasePrice}
		    , #{salePrice}
		    , #{safeStockQuantity}
		    , #{proplace}
		    , #{productImage}
		    , #{major}
		    , #{sub}
		    , #{unit}
		    , #{standard}
		    , #{amount}
		)
	</insert>
<!-- 22 -->
	<!-- 제품정보 수정 -->
	<update id="updateProductList" parameterType="ProductVO">
		UPDATE product
		SET	   <if test="productName != null!">product_name = #{productName}</if>
			   <if test="expriationDeadline != null!">expiration_deadline = #{expriationDeadline}</if>
			   <if test="productPrice != null!">priduct_price = #{productPrice}</if>
			   <if test="salePrice != null!">sale_price = #{salePrice}</if>
			   <if test="safeStockQuantity != null!">safe_stock_quantity = #{safeStockQuantity}</if>
			   <if test="proplace != null!">proplace = #{proplace}</if>
			   <if test="product_image != null!">product_image = #{product_image}</if>
			   <if test="major != null!">major = #{major}</if>
			   <if test="sub != null!">sub = #{sub}</if>
			   <if test="unit != null!">unit = #{unit}</if>
			   <if test="standard != null!">standard = #{standard}</if>
		WHERE product_code = #{productCode}
			   
	</update>
	
	<!-- 제품 삭제 -->
	<delete id="deleteProduct" parameterType="String">
		DELETE FROM product
		Where product_code = #{productCode}
	</delete>
	
	<select id="" parameterType="int">
		SELECT  orders_item
		FROM	orders_detale
		WHERE	orders_item = #{ordersItem}
	</select>
	
	
</mapper>